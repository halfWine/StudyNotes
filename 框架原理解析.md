# ReactDOM.render()实现原理是什么？
`ReactDOM.render()`是React中用于将React元素渲染到真实的DOM节点上的函数。它的实现原理可以简要描述如下：

1. **创建虚拟DOM树（Virtual DOM tree）**：当调用`ReactDOM.render()`时，React会将传入的React元素转换为一个虚拟DOM树，也被称为虚拟DOM表示。

2. **比较新旧虚拟DOM树**：React会将新的虚拟DOM树与之前生成的旧的虚拟DOM树进行比较。这个比较过程又称为**协调（reconciliation）**。

3. **查找差异（Finding the differences）**：通过对比新旧虚拟DOM树的结构和属性，React能够发现哪些部分需要更新。React使用一种高效的算法来最小化查找差异的开销。

4. **生成DOM更新指令**：根据差异的结果，React会生成一系列DOM更新指令，这些指令描述了如何将虚拟DOM树中的变化映射到真实的DOM树中。

5. **应用DOM更新指令**：React会使用这些DOM更新指令来直接操作真实的DOM，将其修改为与新的虚拟DOM树一致。

6. **完成渲染**：一旦所有的DOM更新指令都被应用，渲染过程完成，React元素已经成功地被渲染到真实的DOM节点上。

这种虚拟DOM的渲染方式相对于直接操作真实DOM有以下优势：

- **高效的比较算法**：通过比较虚拟DOM树而不是直接操作真实DOM，React能够减少对真实DOM的访问次数，提高性能。

- **批量更新**：React会将多个DOM更新指令捆绑在一起，以最小化对真实DOM的操作次数。这样可以避免频繁的重绘和回流，从而提高性能。

- **跨平台兼容性**：通过使用虚拟DOM，React不仅可以在浏览器中工作，还可以在服务器端（称为服务器端渲染）和移动应用开发中使用。

总结来说，`ReactDOM.render()`函数使用虚拟DOM技术来实现React元素到真实DOM的渲染。通过比较新旧虚拟DOM树，并将差异应用到真实DOM上，React能够提供高效、灵活和跨平台的页面渲染机制。


# useState实现原理

`useState` 在存储状态时并不是通过闭包实现的，它使用了一种叫做 "Fiber" 的机制来管理组件状态。

在 React 内部，每个函数组件都对应一个 "Fiber" 对象，用于表示该组件的状态、属性和其他信息。当调用 `useState` 时，React 在当前组件的 "Fiber" 对象中创建一个新的状态变量，并将其与相应的更新函数配对。这个状态变量和更新函数会被存储在 Fiber 中，以便在组件多次渲染时能够正确地保留和更新它们的值。

由于每次函数组件被调用时都会创建一个全新的 "Fiber" 对象，所以实际上并没有使用闭包来存储状态。React 使用 "Fiber" 对象来追踪每个函数组件的状态，并确保状态在组件重新渲染时是正确的。

虽然 `useState` 不是通过闭包实现的，但它利用了 JavaScript 中闭包的特性来保持状态变量的持久性。每次组件重新渲染时，`useState` 返回的状态变量都会保持其之前的值，而不会被重置为初始值。这使得我们可以在函数组件中跟踪和更新状态，而无需使用类组件和实例变量。